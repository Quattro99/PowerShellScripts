# Entra ID PowerShell scripts
This folder contains all PowerShell scripts associated with Entra ID. For example, here you will find two PowerShell scripts to automate deployment of an Entra ID PIM concept. 

## Automated PIM Management Concept

### Overview

This repository provides scripts to automate the management of security groups and role assignments in Microsoft Graph for Privileged Identity Management (PIM) and permanent role assignments. The scripts streamline group creation, user assignments, and role definitions to enhance access management while ensuring security compliance.

## Components

1. **CreateSecurityGroupsForPIMandPermanentAssigned.ps1**
   - Automates the creation of security groups for PIM and permanent role assignments, along with user assignments.
  
2. **UpdateEIDRoleDefinition.ps1**
   - Updates role definitions in Entra ID (Azure Active Directory) based on specified criteria in a CSV file.

### Input Files

#### For `CreateSecurityGroupsForPIMandPermanentAssigned.ps1`

1. **PIMGroups.csv**
   - **Description**: Contains information for groups to be created for PIM.
   - **Structure**:
     - **DisplayName**: Name of the group.
     - **Description**: Description of the group.
     - **Nickname**: Mail nickname for the group.
     - **RoleDefinitionId**: ID of the role to be assigned.

2. **PAGroups.csv**
   - **Description**: Contains information for groups to be created for permanent assignments.
   - **Structure**: Same as `PIMGroups.csv`.

3. **PIMUserId.txt**
   - **Description**: A text file listing user IDs to be added to PIM groups. Each user ID should be on a new line.

4. **PAUserId.txt**
   - **Description**: A text file listing user IDs to be added to permanent assigned groups. Each user ID should be on a new line.

#### For `UpdateEIDRoleDefinition.ps1`

1. **RoleDefinitions.csv**
   - **Description**: Contains details for role definitions to be updated.
   - **Structure**:
     - **RoleName**: Name of the role to be updated.
     - **NewDescription**: New description of the role.

## How to Use

### Step 1: Prepare Input Files

1. **Edit the Input Files for PIM**:
   - Open `PIMGroups.csv`, `PAGroups.csv`, `PIMUserId.txt`, and `PAUserId.txt` in a spreadsheet application or text editor. Fill in the required fields.
   - Ensure that each user ID in the text files is on its own line.

2. **Edit the Input File for Role Definitions**:
   - Open `RoleDefinitions.csv` and fill in the role names and their new descriptions.

3. **Save the Files**:
   - Ensure that CSV files are saved in UTF-8 format.

### Step 2: Run the Scripts

#### For `CreateSecurityGroupsForPIMandPermanentAssigned.ps1`

1. Open PowerShell and navigate to the directory where the script and input files are located.
2. Execute the script:
   ```powershell
   .\CreateSecurityGroupsForPIMandPermanentAssigned.ps1

   1.  Follow prompts for file paths and group owner IDs.

#### For `UpdateEIDRoleDefinition.ps1`

1.  Open PowerShell and navigate to the directory where the script and input file are located.
2.  Execute the script:

    powershellCode kopieren

    `.\UpdateEIDRoleDefinition.ps1`

3.  Follow prompts for the path of the `RoleDefinitions.csv` file.

### Step 3: Review Outputs

-   After executing the scripts, review the log file generated by each script to verify successful operations and address any errors encountered.

Notes
-----

-   The scripts require appropriate permissions in Entra ID to manage groups and roles.
-   Ensure that the PowerShell modules needed for Microsoft Graph are installed and up-to-date.
-   Modify log file paths in the scripts if needed to store logs in your desired location.

Author
------

-   Michele Blum
-   Created on: 23.03.2024

License
-------

This project is licensed under the MIT License - see the [LICENSE](https://chat.duo-infernale.ch/c/LICENSE) file for details.